window.onload = function(){
  // 필요 변수 선언

  var nBtn = document.querySelectorAll(".next");
  var vali_chk = 0; // 약관동의 확인
  var tel_chk = 0; //전화번호 입력 여부 확인
  var vali_auth = 0; //인증번호 인증 여부 확인

  // //input 엔터키 안되게 ... 접근성 괜찮나..?
  // document.join.addEventListener("keydown",function(evt){
  //   console.log(evt)
  //   if(evt.code === "Enter" || evt.code === "NumpadEnter") evt.preventDefault();
  // })


  // 약관동의 전체 선택
  var allCheck = document.getElementById("all_check");
  var accept = document.querySelectorAll(".inbox");

  allCheck.addEventListener("change",function(e){
    if(e.target.checked){
      for(k=0;k<accept.length;k++){
        accept[k].children[0].checked = true
      }
    }else{
      for(k=0;k<accept.length;k++){
        accept[k].children[0].checked = false
      }
    }
  })
  
  
  // 인증번호 받을 전화번호 입력
  var tel_chk_btn = document.getElementById("tel_chk_btn");
  var auth_num = document.getElementById("authnum")
  tel_chk_btn.addEventListener("click",function(){
    var user_tel = document.getElementById("phone")
    var tel_test = /^[0-9]{10,11}$/g;
      if(tel_test.test(user_tel.value)){
        alert("인증번호를 전송하였습니다.");
        auth_num.focus();
        return tel_chk = 1;
      }else{
        alert("전화번호를 확인해주세요.");
        return false;
      }
    })
    //인증번호 체크(테스트용)
    auth_chk_btn.addEventListener("click",function(){
    var auth_test = /^[0-9]{6,6}$/g;
      if(auth_test.test(auth_num.value)){
        alert("인증이 완료되었습니다.");
        return vali_auth = 1;
      }else{
        alert("인증번호를 확인해주세요.");
        return false;
      }
  })



  nBtn[0].addEventListener("click",function(e){
    // 유효성검사 성공
    var est_chk = document.querySelectorAll(".est_chk");
  
    // 약관동의 유효성 검사
    if(est_chk[0].checked && est_chk[1].checked && est_chk[2].checked){
      vali_chk = 1;
    }
    // 약관동의
    if(vali_chk == 0){
      alert("약관에 동의해주세요");
      return false;
    }
  })    

  nBtn[1].addEventListener("click",function(e){
    // 번호 인증
    if(vali_auth == 0 && tel_chk == 0){
      alert("전화번호를 인증해주세요");
      return false;
    }
  })
}

function user_join(){
  // 에러메세지 입력 구간
  var err_txt = document.querySelectorAll("p.err_txt");
  // 아이디 부분
  var user_id = document.getElementById("user_id");
  var id_test = new RegExp("^[a-zA-Z0-9+-\_.]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$");
  var pw_test = new RegExp("(?=.*\d{1,12})(?=.*[~`!@#$%\^&*()-+=]{1,12})(?=.*[a-zA-Z]{2,12).{8,12}$")
  if(!user_id.value){
    err_txt[0].textContent = "이메일을 입력해주세요.";
    user_id.focus();
    return false;
  }else{err_txt[0].textContent = "";}
  if(!id_test.test(user_id.value)){
    err_txt[0].textContent = "이메일을 확인해주세요.(예시 Id@naver.com)";
    user_id.focus();
    return false;
  }else{err_txt[0].textContent = "";}

  // 패스워드 부분
  var user_pw = document.getElementById("user_pw");

  if(!user_pw.value){
    document.querySelector(".pw_guide").classList.add("hide");
    err_txt[1].textContent = "비밀번호를 입력해주세요"
    user_pw.focus();
    return false;
  }else{err_txt[1].textContent = "";}
  // user_pw.value.length < 8 || user_pw.value.length > 12
  if(!pw_test.test(user_pw.value)){
    document.querySelector(".pw_guide").classList.add("hide");
    err_txt[1].textContent = "영문, 숫자, 특수문자 포함 8~12자만 입력 할 수 있습니다.";
    user_pw.focus();
    return false;
  }else{err_txt[1].textContent = "";}

  // 패스워드 확인 부분
  var user_pwChk = document.getElementById("user_pw_check");
  if(!user_pwChk.value){
    err_txt[2].textContent = "비밀번호를 다시 한번 입력해주세요";
    user_pwChk.focus();
    return false;
  }else{err_txt[2].textContent = "";}
  if(user_pwChk.value != user_pw.value){
    err_txt[2].textContent = "비밀번호를 확인해주세요";
    user_pwChk.focus();
    return false;
  }else{err_txt[2].textContent = "";}
  
  // 닉네임 부분
  var user_name = document.getElementById("user_name");
  // var name_chk = new RegExp("^[가-힣|a-z|A-Z|0-9|]+${3,6}");
  if(!user_name.value){
    err_txt[3].textContent = "별명을 입력해주세요";
    user_name.focus();
    return false;
  }else{err_txt[3].textContent = "";}
  if(user_name.value.length < 3 || user_name.value.length > 6){
    err_txt[3].textContent = "영문,숫자,한글 포함 최소 3자에서 최대 6자 가능";
    user_name.focus();
    return false;
  }else{err_txt[3].textContent = "";}
}